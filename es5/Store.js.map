{"version":3,"sources":["../src/Store.js"],"names":["Store","onChangeCallbacks","__anyChange","state","stateHistory","index","length","newState","historyMode","oldState","push","assign","anyChanges","property","newProperty","oldProperty","triggerChangeCallbacks","callback","undefined","console","error","newValue","oldValue","forEach","callbackList","pull"],"mappings":";;;;;;;qjBAAA;;;;;AAGA;;;;;;;;IAEaA,K,WAAAA,K;AACT,qBAAa;AAAA;;AACT,aAAKC,iBAAL,GAAyB;AACrBC,yBAAa;AADQ,SAAzB;AAGA,aAAKC,KAAL,GAAa,EAAb;AACA,aAAKC,YAAL,GAAoB,EAApB;AACH;;;;2CAEiB;AACd,gBAAIC,QAAQ,KAAKD,YAAL,CAAkBE,MAAlB,GAA2B,CAAvC;;AAEA,mBAAO,KAAKF,YAAL,CAAkBC,KAAlB,CAAP;AACH;;;iCAEQE,Q,EAA6B;AAAA,gBAAnBC,WAAmB,uEAAL,IAAK;;AAClC;AACA,gBAAIC,WAAW,KAAKN,KAApB;;AAEA,gBAAGK,eAAe,IAAlB,EAAuB;AACnB,qBAAKJ,YAAL,CAAkBM,IAAlB,CAAuBD,QAAvB;AACH;;AAED;AACA,iBAAKN,KAAL,GAAa,iBAAEQ,MAAF,CAAS,EAAT,EAAa,KAAKR,KAAlB,EAAyBI,QAAzB,CAAb;;AAEA;AACA,gBAAIK,aAAa,KAAjB;AACA,iBAAI,IAAIC,QAAR,IAAoB,KAAKV,KAAzB,EAA+B;AAC3B,oBAAIW,cAAc,KAAKX,KAAL,CAAWU,QAAX,CAAlB;AACA,oBAAIE,cAAcN,SAASI,QAAT,CAAlB;AACA,oBAAGC,gBAAgBC,WAAnB,EAA+B;AAC3B;AACA,yBAAKC,sBAAL,CAA4BH,QAA5B,EAAsCC,WAAtC,EAAmDC,WAAnD;AACAH,iCAAa,IAAb;AACH;AACJ;;AAED,gBAAGA,UAAH,EAAe,KAAKI,sBAAL,CAA4B,aAA5B,EAA2C,KAAKb,KAAhD,EAAuDM,QAAvD;AAClB;;;2CAEkBQ,Q,EAAmC;AAAA,gBAAzBJ,QAAyB,uEAAd,aAAc;;AAClD,gBAAG,KAAKZ,iBAAL,CAAuBY,QAAvB,KAAoCK,SAAvC,EAAkD,KAAKjB,iBAAL,CAAuBY,QAAvB,IAAmC,EAAnC;;AAElD,gBAAG,OAAOI,QAAP,IAAmB,UAAtB,EAAiC;AAC7BE,wBAAQC,KAAR,CAAc,8CAAd;AACH,aAFD,MAEM;AACF,qBAAKnB,iBAAL,CAAuBY,QAAvB,EAAiCH,IAAjC,CAAsCO,QAAtC;AACH;AACJ;;;+CAEsBJ,Q,EAAUQ,Q,EAAUC,Q,EAAS;AAChD,gBAAG,CAAC,KAAKrB,iBAAL,CAAuBY,QAAvB,CAAJ,EAAsC;;AAEtC,iBAAKZ,iBAAL,CAAuBY,QAAvB,EAAiCU,OAAjC,CAAyC,UAACN,QAAD;AAAA,uBAAYA,SAASI,QAAT,EAAmBC,QAAnB,EAA6BT,QAA7B,CAAZ;AAAA,aAAzC;AACH;;;6CAEoBI,Q,EAAmC;AAAA,gBAAzBJ,QAAyB,uEAAd,aAAc;;AACpD,gBAAIW,eAAe,KAAKvB,iBAAL,CAAuBY,QAAvB,CAAnB;AACA,gBAAGW,gBAAgBN,SAAnB,EAA8B;;AAE9B,iBAAKjB,iBAAL,CAAuBY,QAAvB,IAAmC,iBAAEY,IAAF,CAAOD,YAAP,EAAqBP,QAArB,CAAnC;AACH;;;;;;kBAGUjB,K","file":"Store.js","sourcesContent":["/**\r\n * Created by sam_g on 2/7/2017.\r\n */\r\nimport _ from 'lodash';\r\n\r\nexport class Store{\r\n    constructor(){\r\n        this.onChangeCallbacks = {\r\n            __anyChange: []\r\n        };\r\n        this.state = {};\r\n        this.stateHistory = [];\r\n    }\r\n\r\n    getPreviousState(){\r\n        let index = this.stateHistory.length - 1;\r\n\r\n        return this.stateHistory[index];\r\n    }\r\n\r\n    setState(newState, historyMode = true){\r\n        // Save the old state\r\n        let oldState = this.state;\r\n\r\n        if(historyMode == true){\r\n            this.stateHistory.push(oldState);\r\n        }\r\n\r\n        // Update the state\r\n        this.state = _.assign({}, this.state, newState);\r\n\r\n        // Generate list of shallow changes\r\n        let anyChanges = false;\r\n        for(let property in this.state){\r\n            let newProperty = this.state[property];\r\n            let oldProperty = oldState[property];\r\n            if(newProperty !== oldProperty){\r\n                // changes.push(property);\r\n                this.triggerChangeCallbacks(property, newProperty, oldProperty);\r\n                anyChanges = true;\r\n            }\r\n        }\r\n\r\n        if(anyChanges) this.triggerChangeCallbacks(\"__anyChange\", this.state, oldState);\r\n    }\r\n\r\n    subscribeToChanges(callback, property = \"__anyChange\"){\r\n        if(this.onChangeCallbacks[property] == undefined) this.onChangeCallbacks[property] = [];\r\n\r\n        if(typeof callback != \"function\"){\r\n            console.error(\"Callback given is not a function as expected\");\r\n        }else {\r\n            this.onChangeCallbacks[property].push(callback);\r\n        }\r\n    }\r\n\r\n    triggerChangeCallbacks(property, newValue, oldValue){\r\n        if(!this.onChangeCallbacks[property]) return;\r\n\r\n        this.onChangeCallbacks[property].forEach((callback)=>callback(newValue, oldValue, property));\r\n    }\r\n\r\n    unSubscribeToChanges(callback, property = \"__anyChange\"){\r\n        let callbackList = this.onChangeCallbacks[property];\r\n        if(callbackList == undefined) return;\r\n\r\n        this.onChangeCallbacks[property] = _.pull(callbackList, callback);\r\n    }\r\n}\r\n\r\nexport default Store;"]}